＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊
接点監視送信機 注意警告文書
＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊

【警告！】
 ・このソースはGrove端子を使用しているが、端子のみ互換のためI2C機能(PORT.A)は使用できない。
 　このソースのままI2C機器を接続すると最悪の場合双方の機器が故障するため、Grove端子にPORT.A規格の機器は絶対に接続しない事。
 　(使用する場合はこのソースを根本から改変してからI2C機器を取り付ける必要がある)

 ・上部Hat端子は未使用のため、Hat対応機器または使用に合ったオリジナルの機器を用意してソースを追加すれば使用可能。
 　(例1：I2C対応温度センサーなどを取り付けて気温測定を行う　例2：更に接点出力を可能にする 等)
 　詳しくはスケッチ例→M5stickC→Hatを参照。オリジナルの場合、「G36ピン」は入力専用である事に留意する
 　BAT端子はセル直結のため、バッテリー内蔵ICや電源管理IC(AXP192)が破損する原因になるため使用厳禁。(特にAXP192が破損すると書換が一切できなくなるので注意)

 ・使用可能ACアダプタは 5V1A以上、2A以下の物でUSBジャックのデーター線が未接続解放の物を使用(※テスターを用いて調査)する事
　 データー線が短絡タイプ(DCP Mode)の物や、特にiPhoneの充電器(Divider Mode)はAXP192が破損する原因になるため使用禁止
　 やむを得ない場合はデーター線を未接続開放するアダプターを製作して用いる事。

【注意！】
 ・M5stickCは装置一体で技適申請されているため分解をすると技適失効による電波法違反となりコンプライアンス上問題が生じる可能性があるため分解禁止

 ・内蔵電池(メイン・RTC)の交換は上記の理由により一切不可。電池寿命になった場合は本体交換を検討する。
 　なお、M5StickCはESP32を応用した機器のためソースコードを一部改変すれば応用可能になるので
 　今後入手不可になった場合は以下の点に注意してArduino ESP32の組み合わせで使用する
 　※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※
 　　・停電監視はStickC内蔵のAXP192独自機能のため、移植不可(他のM5Stack、Stickシリーズ、ESPシリーズ同様)
 　　・Grove端子を除き液晶、その他付随機器はほぼすべてM5StickC専用品のため一般のArduinoで使用できるかは不明
 　　・M5StickV(根本違い)やM5Stick(末尾にC無しでモノクロEL画面)は似て非なる製品のため互換性は一切無い
 　　・M5Stackは画面ズレなどが起きるが一部ソースコード修正で十分対応可能(可能であればこれが現実的)
 　※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※


【IFTTT出力電文について】
公開する際に実機が無いため検証できておらず機密性も少ないためクローズソース時代のままとなっている。
表記変更する場合は「　void Send_Check(unsigned int event)　」内の送信内容を変更する

※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※

正常監視(いずれも開である場合)　→　monitoring

接点A(白色)のみ閉　→　caution

接点B(黄色)のみ閉　→　stopped

接点１，２閉　→　error

監視画面にてM5キー(A)を押した場合　→　test

AXP192 外部電圧降下　→　blackout

なお、送信を実行した場合は次の状態変化までIFTTTへ送信を行わない。
(注：monitoring以外の状態の場合、メニュー画面やテスト電文送信も実行しない)
※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※

使用前にあらかじめIFTTTにて上記電文のWebhookトリガーの作成を行い、PrivateKeyをソース内の(const char *privateKey = "　HogeHoge　";)に転記が必要
(※2021年現在、IFTTTで上記電文内容を全て使用する場合は月額課金が必要)


【Groveポートの接点監視回路について】
回路的にはMini Dual Button Unit(SKU: U025)に準じる。
(本番回路では誤動作抑制のためにプルダウン抵抗追加を推奨)


【時刻設定について】
デフォルトでは毎時８：３０に「ntp.nict.jp」から自動で取得して自動的に時刻調整される。(詳細は「RTCView()」内参照)
